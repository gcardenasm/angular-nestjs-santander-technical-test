<form [formGroup]="form" (ngSubmit)="submit()" class="candidate-form" [class.entered]="entered"
  aria-busy="{{ loading }}">
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Name</mat-label>
    <input matInput formControlName="name" required />
  </mat-form-field>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Surname</mat-label>
    <input matInput formControlName="surname" required />
  </mat-form-field>

  <div class="file-picker" [class.invalid]="form.controls.file.invalid && form.touched">
    <input #fileInput type="file" class="visually-hidden" (change)="onFileChange($event)" accept=".xlsx,.xls"
      aria-label="Select Excel file with candidate data" />

    <button mat-stroked-button type="button" (click)="fileInput.click()" [disabled]="loading">
      <mat-icon aria-hidden="true">upload_file</mat-icon>
      <span>{{ form.value.file?.name || 'Seleccionar Excel…' }}</span>
    </button>

    <div class="file-help">
      <small>Formatos admitidos: .xlsx, .xls (una única fila de datos)</small>
      <small *ngIf="form.controls.file.invalid && form.touched" class="error">
        Es obligatorio seleccionar un archivo
      </small>
    </div>
  </div>

  <button mat-raised-button color="primary" type="submit" [disabled]="loading || form.invalid">
    {{ loading ? 'Processing…' : 'Submit' }}
  </button>
</form>